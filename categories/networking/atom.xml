<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: networking | StevenOcchipinti.com]]></title>
  <link href="http://blog.stevenocchipinti.com/categories/networking/atom.xml" rel="self"/>
  <link href="http://blog.stevenocchipinti.com/"/>
  <updated>2014-03-10T16:50:52+11:00</updated>
  <id>http://blog.stevenocchipinti.com/</id>
  <author>
    <name><![CDATA[Steven Occhipinti]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[TCPDump]]></title>
    <link href="http://blog.stevenocchipinti.com/TCPDump.html"/>
    <updated>2013-11-08T01:35:00+11:00</updated>
    <id>http://blog.stevenocchipinti.com/TCPDump</id>
    <content type="html"><![CDATA[<h2>Example</h2>

<p>```
  sudo tcpdump -A -s 500 -vvv -i lo0  src host 1.2.3.4</p>

<pre><code>          |_____________________||________________|
                  options            expression
</code></pre>

<p>```</p>

<h2>Options</h2>

<p><code>
  -D                  # list interfaces
  -i en0              # use en0 interface
  -vv                 # very verbose
  -nn                 # Dont resolve hostnames
  -c                  # count packets
  -A                  # show in ASCII
  -X                  # show in HEX
  -tttt               # display date and time
  -S                  # print absolute sequence numbers (instead of relative)
  -s                  # number of byte (-s 0 is unlimited)
  -w file.pcap        # write packets to file.pcap
  -r file.pcap        # read packets from file.pcap
</code></p>

<h2>Expressions</h2>

<p><code>
  src host 1.2.3.4    # source address
  src net 1.2.3.0/24  # source network
  dst host 1.2.3.4    # destination network
  dst net 1.2.3.0/24  # destination network
  port 53             # port number
</code></p>

<h2>Capturing HTTP traffic</h2>

<p><a href="http://stackoverflow.com/questions/4777042/can-i-use-tcpdump-to-get-http-requests-response-header-and-response-body">http://stackoverflow.com/questions/4777042/can-i-use-tcpdump-to-get-http-requests-response-header-and-response-body</a></p>

<p>GET requests:</p>

<p><code>
tcpdump -s 0 -A 'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420'
</code></p>

<p>POST requests:</p>

<p><code>
tcpdump -lnA 'tcp dst port 80 and (tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x504f5354)'
</code></p>

<h2>Wireshark</h2>

<p><code>
  edit -&gt; preferences -&gt; protocols -&gt; http -&gt; tcp ports
</code></p>

<h2>NGrep</h2>

<p><code>
ngrep -q -d en1 -W byline -O sas.pcap host reatst.aimatch.com and port 80
</code></p>
]]></content>
  </entry>
  
</feed>
